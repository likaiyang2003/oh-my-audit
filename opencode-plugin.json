{
  "name": "code-security-audit",
  "version": "1.0.0",
  "description": "Professional Java code security audit plugin for OpenCode",
  "entry": "src/index.ts",
  "type": "tool",
  "tools": [
    {
      "name": "audit_jar",
      "description": "Security audit a Java JAR file for vulnerabilities including SQL injection, SSRF, RCE, and business logic flaws",
      "parameters": {
        "type": "object",
        "properties": {
          "jarPath": {
            "type": "string",
            "description": "Path to the JAR file to audit"
          },
          "severityFilter": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["critical", "high", "medium", "low"]
            },
            "description": "Filter vulnerabilities by severity level (default: all)",
            "default": ["critical", "high", "medium", "low"]
          },
          "reportFormat": {
            "type": "string",
            "enum": ["console", "json", "html", "markdown"],
            "description": "Output format for the audit report",
            "default": "console"
          }
        },
        "required": ["jarPath"]
      }
    },
    {
      "name": "decompile_class",
      "description": "Decompile a Java class file to source code using CFR decompiler",
      "parameters": {
        "type": "object",
        "properties": {
          "jarPath": {
            "type": "string",
            "description": "Path to the JAR file containing the class"
          },
          "className": {
            "type": "string",
            "description": "Fully qualified class name (e.g., com.example.MyClass)"
          }
        },
        "required": ["jarPath", "className"]
      }
    },
    {
      "name": "analyze_taint",
      "description": "Perform taint analysis on Java source code to track data flow from sources to sinks",
      "parameters": {
        "type": "object",
        "properties": {
          "sourceCode": {
            "type": "string",
            "description": "Java source code to analyze"
          },
          "entryPoints": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Method names that serve as entry points (e.g., doGet, doPost)"
          }
        },
        "required": ["sourceCode"]
      }
    },
    {
      "name": "detect_sql_injection",
      "description": "Detect SQL injection vulnerabilities in Java code by analyzing string concatenation and query construction",
      "parameters": {
        "type": "object",
        "properties": {
          "sourceCode": {
            "type": "string",
            "description": "Java source code to analyze"
          },
          "methodName": {
            "type": "string",
            "description": "Name of the method to analyze"
          }
        },
        "required": ["sourceCode"]
      }
    },
    {
      "name": "detect_ssrf",
      "description": "Detect Server-Side Request Forgery (SSRF) vulnerabilities in Java code",
      "parameters": {
        "type": "object",
        "properties": {
          "sourceCode": {
            "type": "string",
            "description": "Java source code to analyze"
          },
          "checkInternalIPs": {
            "type": "boolean",
            "description": "Also check for internal IP access attempts",
            "default": true
          }
        },
        "required": ["sourceCode"]
      }
    },
    {
      "name": "detect_rce",
      "description": "Detect Remote Code Execution (RCE) vulnerabilities including command injection and unsafe deserialization",
      "parameters": {
        "type": "object",
        "properties": {
          "sourceCode": {
            "type": "string",
            "description": "Java source code to analyze"
          }
        },
        "required": ["sourceCode"]
      }
    },
    {
      "name": "detect_auth_vulnerabilities",
      "description": "Detect authentication and authorization vulnerabilities including IDOR, JWT issues, and missing access controls",
      "parameters": {
        "type": "object",
        "properties": {
          "sourceCode": {
            "type": "string",
            "description": "Java source code to analyze"
          },
          "checkJWT": {
            "type": "boolean",
            "description": "Check for JWT vulnerabilities",
            "default": true
          },
          "checkIDOR": {
            "type": "boolean",
            "description": "Check for IDOR (Insecure Direct Object Reference)",
            "default": true
          }
        },
        "required": ["sourceCode"]
      }
    },
    {
      "name": "detect_business_logic",
      "description": "Detect business logic vulnerabilities including price manipulation, race conditions, and workflow bypass",
      "parameters": {
        "type": "object",
        "properties": {
          "sourceCode": {
            "type": "string",
            "description": "Java source code to analyze"
          },
          "context": {
            "type": "string",
            "enum": ["ecommerce", "banking", "general"],
            "description": "Application context for targeted detection",
            "default": "general"
          }
        },
        "required": ["sourceCode"]
      }
    },
    {
      "name": "generate_audit_report",
      "description": "Generate security audit report in various formats (console, JSON, HTML, Markdown)",
      "parameters": {
        "type": "object",
        "properties": {
          "vulnerabilities": {
            "type": "array",
            "description": "Array of vulnerability objects"
          },
          "format": {
            "type": "string",
            "enum": ["console", "json", "html", "markdown"],
            "description": "Report output format",
            "default": "console"
          },
          "includeRemediation": {
            "type": "boolean",
            "description": "Include remediation suggestions in report",
            "default": true
          }
        },
        "required": ["vulnerabilities"]
      }
    }
  ],
  "permissions": [
    "file-system-read"
  ],
  "supportedModels": [
    "claude",
    "gpt-4",
    "gemini",
    "grok",
    "glm"
  ],
  "requirements": {
    "bun": ">=1.0.0",
    "java": ">=8"
  },
  "documentation": {
    "usage": "docs/USAGE.md",
    "api": "docs/API.md",
    "configuration": "docs/CONFIGURATION.md"
  }
}
